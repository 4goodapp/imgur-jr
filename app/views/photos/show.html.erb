<h2>Current photo: <%= @photo.title %> </h2>
<br>

<img src="<%= @photo.url%>">
<br>

<% if current_user %>
     <%= form_for [@photo, Vote.new] do |f| %>
      <%= f.label "Votes: #{@photo.votes.count}" %>
      <%= f.submit %>
      <% end %>
<% end %>


<h3>Comments</h3>
<% @photo.comments.order("vote_count DESC").each do |c| %>
  <%= "#{c.user.username}: (#{c.vote_count}) [#{c.id}]" %><br>

  <% if current_user %>
    <!-- The c.id tag on the line below always defaults to the first comment in the thread! -->
    <%= form_tag("/photos/#{@photo.id}/comments/#{c.id}/votes", method: "post") do %>
      <%= submit_tag("Vote") %>
    <% end %>
    <!-- there should be an end tag here for the form_tag, but i get an error if i put it -->
  <% end %>

  <% time = c.created_at.in_time_zone("Eastern Time (US & Canada)") %>
  <%= time.strftime("%m/%d/%Y %I:%M%p") %><br>
  <%= c.text %><br><br>
<% end %>

<br>

<% if current_user %>
     <%= form_for [@photo, Comment.new] do |f| %>
      <%= f.label :comment, "Comment" %>
      <%= f.text_area :text %>
      <%= f.submit %>
      <% end %>
<% end %>

<%= link_to "Back", root_url %>
